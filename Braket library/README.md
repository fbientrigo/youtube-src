This part contains a conversion of a code from maple, to a version compatible with sympy;
sympy has a different way to express stuff so many workarounds have to me made